# lock script
set $lock ~/.config/sway/lock.sh

# modifiers
set $mod Mod1
set $sup Mod4
floating_modifier $mod

#.......
# Inputs
#.......

# swaymsg -t get_inputs

input 1:1:AT_Translated_Set_2_keyboard {
        xkb_layout us
        xkb_numlock enable
        xkb_options ctrl:nocaps
}

input 1130:17:HID_046a:0011 {
        xkb_layout us
        xkb_numlock enable
        xkb_options ctrl:nocaps
}

input 1118:219:Microsoft_Natural___Ergonomic_Keyboard_4000 {
        xkb_layout us
        xkb_numlock enable
        xkb_options ctrl:nocaps
}

#........
# Outputs
#........

# https://www.mankier.com/5/sway-output#Commands
# swaymsg -t get_outputs

output eDP-1 bg '#000000' solid_color
output HDMI-A-2 bg '#000000' solid_color

#..................
# Workspace screens
#..................

workspace 1 output HDMI-A-2
workspace 2 output eDP-1
workspace 3 output HDMI-A-2
workspace 4 output HDMI-A-2
workspace 5 output eDP-1
workspace 8 output HDMI-A-2
workspace 9 output HDMI-A-2
workspace 10 output eDP-1

#........
# Windows
#........

font pango:JetBrains Mono 12px
focus_follows_mouse no
mouse_warping none
hide_edge_borders smart
default_border normal

#.........
# Keybinds
#.........

# change focus
bindsym $mod+j focus left
bindsym $mod+k focus down
bindsym $mod+l focus up
bindsym $mod+semicolon focus right

# move focused window
bindsym $mod+Shift+j move left
bindsym $mod+Shift+k move down
bindsym $mod+Shift+l move up
bindsym $mod+Shift+semicolon move right

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9
bindsym $mod+0 workspace 10
bindsym $mod+b workspace back_and_forth

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9
bindsym $mod+Shift+0 move container to workspace 10

# move focused workspace to monitor
bindsym $sup+Shift+j move workspace to output left
bindsym $sup+Shift+semicolon move workspace to output right

# split and fullscreen
bindsym $mod+h split h
bindsym $mod+v split v
bindsym $mod+f fullscreen toggle

# change container layout
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# change window border
bindsym $mod+t border normal
bindsym $mod+y border pixel
bindsym $mod+u border none

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle
# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# focus the parent container
bindsym $mod+a focus parent
# focus the child container
bindsym $mod+q focus child

# resize window
bindsym $mod+r mode "resize"
mode "resize" {
        bindsym j resize shrink width 10 px or 10 ppt
        bindsym k resize grow height 10 px or 10 ppt
        bindsym l resize shrink height 10 px or 10 ppt
        bindsym semicolon resize grow width 10 px or 10 ppt
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

# dock toggle
bindsym $mod+m mode "dock toggle: (d)ock (e)xtended (u)ndock"
mode "dock toggle: (d)ock (e)xtended (u)ndock" {
        bindsym d exec swaymsg output eDP-1 disable && swaymsg output HDMI-A-2 enable bg '#000000' solid_color && swaymsg output HDMI-A-2 transform 270, mode "default"
        bindsym e exec swaymsg output eDP-1 enable bg '#000000' solid_color pos 0 1020 && swaymsg output HDMI-A-2 enable bg '#000000' solid_color pos 1600 0 && swaymsg output HDMI-A-2 transform 270, mode "default"
        #   0:0           1600:0
        #   +             +---------+   eDP-1:
        #                 | HDMI-A-2|     - 3200x1800
        #                 |         |     - scale 2
        #   0:1020        | 1920x   |     → 1600x900
        #   +------------+| 1080    |
        #   |            ||         |   HDMI-A-2:
        #   |  eDP-1     || rotate: |     - 1920x1080
        #   |  3200x1800 || 270     |     - rotate 270
        #   |  scale 2   ||         |     → 1080x1920
        #   +------------++---------+
        bindsym u exec swaymsg output eDP-1 enable bg '#000000' solid_color && swaymsg output HDMI-A-2 disable, mode "default"
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

# exit sway
bindsym $mod+Shift+e mode "exit: (l)ogout (s)uspend (r)eboot (p)oweroff"
mode "exit: (l)ogout (s)uspend (r)eboot (p)oweroff" {
        bindsym l exit
        bindsym s exec ($lock &) && systemctl suspend, mode "default"
        bindsym r exec systemctl reboot
        bindsym p exec systemctl poweroff
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

bindsym $mod+Shift+c reload
bindsym $mod+Shift+grave move scratchpad
bindsym $mod+grave scratchpad show
bindsym $sup+l exec $lock
bindsym $mod+Return exec alacritty
bindsym Print exec grim -g "$(slurp -d)" - | tee ~/tmp/$(date +'%Y-%m-%d-%H%M%S.png') | wl-copy
bindsym $mod+Shift+q kill

# xev - X events (xorg-xev)

# audio
bindsym $sup+Up exec pactl set-sink-volume @DEFAULT_SINK@ +10%
bindsym $sup+Down exec pactl set-sink-volume @DEFAULT_SINK@ -10%
bindsym $sup+m exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +10%
bindsym XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -10%
bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle
bindsym XF86AudioPlay exec dbus-send --print-reply --dest=org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Player.PlayPause
bindsym XF86AudioNext exec dbus-send --print-reply --dest=org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Player.Next
bindsym XF86AudioPrev exec dbus-send --print-reply --dest=org.mpris.MediaPlayer2.spotify /org/mpris/MediaPlayer2 org.mpris.MediaPlayer2.Player.Previous

# screen
bindsym $sup+Right exec brightnessctl s +10%
bindsym $sup+Left exec brightnessctl s 10%-
bindsym XF86MonBrightnessDown exec brightnessctl s 10%-
bindsym XF86MonBrightnessUp exec brightnessctl s +10%
bindsym XF86Display mode "dock toggle: (d)ock (e)xtended (u)ndock"

# other
# bindsym XF86Tools
# bindsym XF86Search
# bindsym XF86LaunchA
# bindsym XF86Explorer

#...........
# Status bar
#...........

bar {
        status_command i3status -c ~/.config/sway/status
        bindsym button4 nop
        bindsym button5 nop
        tray_output primary
}

#.......................
# Specific apps settings
#.......................

# xprop
# swaymsg -t get_tree

for_window [title="scratchpad"] move scratchpad # FIXME: doesn't work
for_window [window_role="pop-up"] floating enable
for_window [class=".*Tor Browser"] floating enable
for_window [class="Firefox" window_role="browser"] layout tabbed
for_window [class="DevTools.*"] layout tabbed
for_window [class="Spotify"] layout tabbed

assign [title=".*Mozilla*"] → 1
assign [class="(?i)vlc"] → 5
assign [class="(?i)libreoffice*"] → 5
assign [class="(?i)Spotify"] → 5
assign [class=".*Developer Edition"] → 8
assign [class=".*Chromium"] → 8
assign [class=".*Developer Edition" window_role="toolbox"] → 9
assign [class="DevTools.*"] → 9
assign [class="top" instance="^top$"] → 10
